# Neovim 自定义快捷键速查表

> Leader 键：`Space`（空格）
> 本文档仅列出配置中自定义的快捷键，不包含 Vim 原生命令

## 基础操作

### 编辑器导航

| 快捷键      | 功能                        |
| ----------- | --------------------------- |
| `H`         | 跳到行首（非空白）          |
| `L`         | 跳到行尾                    |
| `<A-Left>`  | 返回上一位置（类 VSCode）   |
| `<A-Right>` | 前进到下一位置（类 VSCode） |

### 系统剪贴板

| 快捷键      | 功能             |
| ----------- | ---------------- |
| `<leader>y` | 复制到系统剪贴板 |
| `<leader>p` | 从系统剪贴板粘贴 |

### 退出与保存

使用 Vim 原生快捷键：

| 快捷键 | 功能           | 等同命令 |
| ------ | -------------- | -------- |
| `ZZ`   | 保存并退出     | `:wq`    |
| `ZQ`   | 不保存直接退出 | `:q!`    |

💡 **提示**：

- **使用 `ZZ` 或 `ZQ` 退出前，需要先手动关闭 Neo-tree**（在 Neo-tree 中按 `q`），否则会提示无法退出
- 多窗口时可用 `:wqa`（保存所有并退出）或 `:qa!`（强制退出所有）
- Neovide/GUI：使用 `Cmd+Q` (macOS) 或 `Alt+F4` (Linux/Windows) 退出客户端

---

## 标签页管理 ⭐

| 快捷键            | 功能                  |
| ----------------- | --------------------- |
| `<A-w>`           | 关闭当前标签页        |
| `<A-[>`           | 上一个标签页          |
| `<A-]>`           | 下一个标签页          |
| `<A-1>` ~ `<A-9>` | 跳转到第 1~9 个标签页 |

💡 **提示**：

- macOS 用户需使用左侧 Option 键（已配置 `neovide_input_macos_option_key_is_meta = "only_left"`）
- `Alt+h/j/k/l` 已用于移动行/代码块（见下文"代码移动"章节）
- 💡 在 Neo-tree 中按 `t` 可在新标签页中打开文件

---

## 窗口管理

### 窗口导航

| 快捷键  | 功能           |
| ------- | -------------- |
| `<C-h>` | 移动到左侧窗口 |
| `<C-j>` | 移动到下方窗口 |
| `<C-k>` | 移动到上方窗口 |
| `<C-l>` | 移动到右侧窗口 |

### 窗口大小调整

| 快捷键       | 功能             |
| ------------ | ---------------- |
| `<leader>rh` | 向左调整窗口大小 |
| `<leader>rj` | 向下调整窗口大小 |
| `<leader>rk` | 向上调整窗口大小 |
| `<leader>rl` | 向右调整窗口大小 |

💡 **提示**：也可以用鼠标拖动窗口分隔线调整大小

### 窗口管理

| 快捷键       | 功能             |
| ------------ | ---------------- |
| `<leader>wd` | 关闭当前窗口     |
| `<leader>wD` | 强制关闭当前窗口 |
| `<leader>wo` | 关闭其他所有窗口 |

---

## Buffer 管理

| 快捷键       | 功能            |
| ------------ | --------------- |
| `<leader>bd` | 关闭当前 buffer |

---

## 文件浏览与搜索

### Neo-tree（文件树）

| 快捷键      | 功能                                           |
| ----------- | ---------------------------------------------- |
| `<leader>e` | 打开并聚焦文件树（未打开则打开，已打开则聚焦） |

**在 Neo-tree 中**（默认快捷键）：

**导航与选择**：
| 按键 | 功能 |
|------|------|
| `<CR>`(`ENTER`) | 打开文件/展开目录 |
| `<Space>` | 切换节点展开/收起 |
| `<Esc>` | 取消/关闭预览 |
| `<` / `>` | 切换到上一个/下一个源（filesystem/git/buffers） |
| `<bs>` | 返回上级目录 |
| `.` | 设置当前目录为根目录 |

**文件操作**：
| 按键 | 功能 |
|------|------|
| `a` | 新建文件 |
| `A` | 新建目录 |
| `d` | 删除文件/目录 |
| `r` | 重命名文件/目录 |
| `b` | 重命名（仅修改basename） |
| `c` | 复制文件 |
| `m` | 移动文件 |
| `y` | 复制到剪贴板 |
| `x` | 剪切到剪贴板 |
| `p` | 从剪贴板粘贴 |
| `<C-r>` | 清空剪贴板 |

**视图控制**：
| 按键 | 功能 |
|------|------|
| `e` | 切换自动扩展宽度（调整目录树宽度） |
| `P` | 切换预览窗口 |
| `l` | 聚焦预览窗口 |
| `<C-f>` / `<C-b>` | 预览窗口向下/向上滚动 |
| `z` | 关闭所有节点 |
| `R` | 刷新文件树 |
| `C` | 关闭节点 |
| `H` | 切换显示/隐藏隐藏文件 |

**窗口管理**：
| 按键 | 功能 |
|------|------|
| `S` | 在水平分屏中打开 |
| `s` | 在垂直分屏中打开 |
| `t` | 在新标签页中打开 |
| `w` | 用窗口选择器打开 |
| `q` | 关闭 Neo-tree 窗口 |
| `?` | 显示帮助（查看所有快捷键） |

**搜索与过滤**：
| 按键 | 功能 |
|------|------|
| `/` | 模糊搜索文件 |
| `D` | 模糊搜索目录 |
| `#` | 模糊排序 |
| `f` | 提交过滤器 |
| `<C-x>` | 清除过滤器 |
| `i` | 显示文件详情 |

**Git 导航**：
| 按键 | 功能 |
|------|------|
| `[g` | 跳转到上一个 Git 修改 |
| `]g` | 跳转到下一个 Git 修改 |

**排序**（`o` 前缀）：
| 按键 | 功能 |
|------|------|
| `oc` | 按创建时间排序 |
| `od` | 按诊断排序 |
| `og` | 按 Git 状态排序 |
| `om` | 按修改时间排序 |
| `on` | 按名称排序 |
| `os` | 按大小排序 |
| `ot` | 按类型排序 |

💡 **提示**：

- 在 Neo-tree 中按 `?` 可查看完整的快捷键列表
- 创建目录时使用 `A` 键（大写）

### Telescope（模糊搜索）

| 快捷键       | 功能                     |
| ------------ | ------------------------ |
| `<leader>ff` | 查找文件                 |
| `<leader>fg` | 全局搜索（需要 ripgrep） |
| `<leader>fc` | 当前文件内搜索           |

---

## 代码操作

### LSP

| 快捷键       | 功能                    |
| ------------ | ----------------------- |
| `gd`         | 跳转到定义              |
| `gr`         | 查找引用                |
| `gi`         | 跳转到实现              |
| `K`          | 显示悬浮文档            |
| `<leader>rn` | 重命名符号              |
| `<leader>ca` | 代码操作（Code Action） |

💡 **Inlay Hints（类型提示）**：
- **默认启用**：在 C/C++ 文件中会自动显示类型推导（如 `auto` 变量的实际类型）、函数参数名等内联提示
- **手动关闭**：如需关闭，在命令模式输入：`:lua vim.lsp.inlay_hint.enable(false)`
- **重新开启**：`:lua vim.lsp.inlay_hint.enable(true)`
- **要求**：Neovim ≥ 0.10.0 且 LSP 服务器支持（已配置 clangd）

### 格式化与诊断

| 快捷键       | 功能              |
| ------------ | ----------------- |
| `<leader>cf` | 格式化当前 buffer |
| `<leader>cd` | 查看当前行诊断    |
| `<leader>cj` | 跳转到下一个诊断  |
| `<leader>ck` | 跳转到上一个诊断  |

### 代码移动（nvim-gomove）

**Normal 模式**：
| 快捷键 | 功能 |
|--------|------|
| `<A-h>` | 向左移动当前行 |
| `<A-j>` | 向下移动当前行 |
| `<A-k>` | 向上移动当前行 |
| `<A-l>` | 向右移动当前行 |

**Visual 模式**：
| 快捷键 | 功能 |
|--------|------|
| `<A-h>` | 向左移动选中代码块 |
| `<A-j>` | 向下移动选中代码块 |
| `<A-k>` | 向上移动选中代码块 |
| `<A-l>` | 向右移动选中代码块 |

💡 **提示**：移动代码时会自动重新缩进并支持撤销合并

---

## CMake

| 快捷键       | 功能            |
| ------------ | --------------- |
| `<leader>mg` | CMake 生成/配置 |
| `<leader>mb` | CMake 构建      |
| `<leader>mr` | CMake 运行      |
| `<leader>mc` | CMake 清理      |
| `<leader>mt` | 选择构建目标    |
| `<leader>ml` | 选择运行目标    |
| `<leader>mp` | 选择构建预设    |
| `<leader>ms` | 停止 CMake      |

### 典型工作流程

1. `<leader>mg` - 配置项目（首次或修改 CMakeLists.txt 后）
2. `<leader>mt` - 选择要构建的目标
3. `<leader>mb` - 构建选定的目标
4. `<leader>ml` - 选择要运行的目标（如果有多个可执行文件）
5. `<leader>mr` - 运行程序

---

## 终端（ToggleTerm）

| 快捷键       | 功能          |
| ------------ | ------------- |
| `<C-\>`      | 打开/关闭终端 |
| `<leader>t1` | 切换终端 1    |
| `<leader>t2` | 切换终端 2    |
| `<leader>tf` | 浮动终端      |
| `<leader>tq` | 关闭当前终端  |
| `<leader>tQ` | 关闭所有终端  |

**在终端模式中**：
| 快捷键 | 功能 |
|--------|------|
| `<Esc>` | 退出终端模式（进入 Normal 模式） |
| `<C-h>` | 切换到左侧窗口 |
| `<C-l>` | 切换到右侧窗口 |

---

## Git (Diffview)

### Diff 视图操作

| 快捷键       | 功能                               |
| ------------ | ---------------------------------- |
| `<leader>dv` | 打开 Diffview（对比工作区与 HEAD） |
| `<leader>dh` | 查看当前文件的 Git 历史            |
| `<leader>dH` | 查看整个项目的 Git 历史            |

💡 **提示**：使用 `<Alt-w>` 关闭 Diffview 标签页（见"标签页管理"章节）

**Visual 模式**：
| 快捷键 | 功能 |
|--------|------|
| `<leader>dh` | 查看选中行的 Git 演进历史（行级跟踪） |

### 在 Diffview 中（Diff 视图）

**文件导航**：
| 快捷键 | 功能 |
|--------|------|
| `<Tab>` | 下一个文件 |
| `<S-Tab>` | 上一个文件 |
| `gf` | 在上一个标签页打开文件 |
| `<C-w><C-f>` | 在新分割窗口打开文件 |
| `<C-w>gf` | 在新标签页打开文件 |

**视图控制**：
| 快捷键 | 功能 |
|--------|------|
| `<leader>e` | 聚焦文件面板 |
| `<leader>b` | 切换文件面板显示/隐藏 |
| `g<C-x>` | 切换布局方式（水平/垂直） |
| `R` | 刷新 diff 视图 |

**合并冲突解决**（三路合并时）：
| 快捷键 | 功能 |
|--------|------|
| `<leader>co` | 选择 OURS（当前分支的版本） |
| `<leader>ct` | 选择 THEIRS（合并分支的版本） |
| `<leader>cb` | 选择 BASE（共同祖先版本） |
| `<leader>ca` | 保留所有版本（both） |
| `dx` | 删除冲突区域 |
| `[x` | 跳转到上一个冲突 |
| `]x` | 跳转到下一个冲突 |

**Stage/Unstage**：
| 快捷键 | 功能 |
|--------|------|
| `<leader>hs` | Stage 所有改动 |
| `<leader>hu` | Unstage 所有改动 |

### 在文件面板中

| 快捷键             | 功能                |
| ------------------ | ------------------- |
| `j` / `k`          | 上下导航            |
| `<CR>` / `o` / `l` | 打开文件的 diff     |
| `s` / `-`          | Stage/Unstage 文件  |
| `S`                | Stage 所有文件      |
| `U`                | Unstage 所有文件    |
| `R`                | 刷新文件列表        |
| `i`                | 切换 tree/list 视图 |
| `f`                | 扁平化目录显示      |

### 常用命令

| 命令                               | 功能                                |
| ---------------------------------- | ----------------------------------- |
| `:DiffviewOpen`                    | 打开 diff 视图（对比工作区与 HEAD） |
| `:DiffviewOpen HEAD~2`             | 对比工作区与 2 个提交前             |
| `:DiffviewOpen origin/main...HEAD` | 对比当前分支与 origin/main 的差异   |
| `:DiffviewFileHistory`             | 查看整个项目的提交历史              |
| `:DiffviewFileHistory %`           | 查看当前文件的提交历史              |

💡 **提示**：

- 在三路合并时（merge/rebase），冲突文件会自动以三栏布局显示：`LOCAL | BASE | REMOTE`
- 使用 `<leader>co/ct/cb` 快速选择要保留的版本
- 选中代码行后使用 `:'<,'>DiffviewFileHistory` 可追踪这些行的演进历史

---

## 代码折叠

| 快捷键       | 功能             | 等同于 |
| ------------ | ---------------- | ------ |
| `<leader>zo` | 展开所有折叠     | `zR`   |
| `<leader>zc` | 折叠所有代码块   | `zM`   |
| `<leader>zt` | 切换当前折叠状态 | `za`   |
| `<leader>zu` | 展开当前折叠     | `zo`   |
| `<leader>zz` | 折叠当前代码块   | `zc`   |

---

## Python 开发

| 快捷键       | 功能                          |
| ------------ | ----------------------------- |
| `<leader>va` | 激活项目 .venv 并重启 Pyright |

---

## 补全（nvim-cmp）

**在补全菜单中**：
| 快捷键 | 功能 |
|--------|------|
| `<Tab>` | 确认补全 / 跳转到下一个片段位置 |
| `<S-Tab>` | 跳转到上一个片段位置 |
| `<C-j>` | 选择下一个补全项 |
| `<C-k>` | 选择上一个补全项 |
| `<CR>` | 确认选择 |
| `<C-e>` | 关闭补全菜单 |

---

## 字体缩放（仅 Neovide）

| 快捷键  | 功能         |
| ------- | ------------ |
| `<C-=>` | 放大字体     |
| `<C-->` | 缩小字体     |
| `<C-0>` | 恢复默认字号 |

---

## 按键前缀分组

| 前缀        | 用途                                |
| ----------- | ----------------------------------- |
| `<leader>b` | Buffer 管理                         |
| `<leader>c` | 代码操作（Code/Conflict）           |
| `<leader>d` | Diffview（Git diff 和历史）         |
| `<leader>e` | 文件树（Explorer）                  |
| `<leader>f` | 查找（Find/Search）                 |
| `<leader>h` | Hunk 操作（Stage/Unstage Git 改动） |
| `<leader>m` | CMake 构建                          |
| `<leader>r` | 重命名/窗口调整（Rename/Resize）    |
| `<leader>t` | 终端（Terminal）                    |
| `<leader>v` | Python 虚拟环境（Venv）             |
| `<leader>w` | 窗口管理（Window）                  |
| `<leader>z` | 折叠（Fold）                        |
